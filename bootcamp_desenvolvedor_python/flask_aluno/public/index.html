<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>User List</title>
<style>
    body { font-family: Arial, sans-serif; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 8px; text-align: left; border-bottom: 1px solid #ddd; }
    nav ul { padding: 0; }
    nav ul li { display: inline; margin-right: 10px; }
</style>
</head>
<body>
    <h1>User List</h1>
    <nav>
        <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/create">Create User</a></li>
            <li><a href="/update">Update User</a></li>
        </ul>
    </nav>
    <table id="usersTable">
        <thead>
            <tr>
                <th>Name</th>
                <th>Phone</th>
                <th>Address</th>
                <th>CPF</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <!-- User data rows will be inserted here via JavaScript -->
        </tbody>
    </table>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            fetch('/users')
            .then(response => response.json())
            .then(data => {
                const table = document.getElementById('usersTable').getElementsByTagName('tbody')[0];
                data.forEach(user => {
                    const row = table.insertRow();
                    row.insertCell(0).textContent = user.name;
                    row.insertCell(1).textContent = user.phone;
                    row.insertCell(2).textContent = user.address;
                    row.insertCell(3).textContent = user.cpf;
                    row.insertCell(4).innerHTML = `<a href="view?id=${user.id}">View</a> | <a href="edit?id=${user.id}">Edit</a> | <a href="#" onclick="deleteUser(${user.id}); return false;">Delete</a>`;
                });
            })
            .catch(error => console.error('Error fetching users:', error));
        });

        function deleteUser(userId) {
            if (confirm('Are you sure you want to delete this user?')) {
                fetch(`/user/${userId}`, { method: 'DELETE' })
                .then(response => response.json())
                .then(data => {
                    console.log(data.message);
                    window.location.reload();  // Reload the page to update the list
                })
                .catch(error => console.error('Error deleting user:', error));
            }
        }
    </script>
</body>
</html>
